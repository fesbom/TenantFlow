Atue como um desenvolvedor Full Stack s√™nior. Preciso implementar um m√≥dulo de agendamento via WhatsApp integrado ao meu sistema de cl√≠nicas. O sistema deve usar a API do Google Gemini para processar mensagens e a Twilio como ponte para o WhatsApp.

Requisitos T√©cnicos:

Banco de Dados (SQLite): Crie tabelas para conversations (id, phone, status: 'ai' ou 'human', last_update) e chat_messages (id, conversation_id, sender: 'patient', 'ai' ou 'staff', text, timestamp).

Integra√ß√£o Gemini: Crie uma rotina que receba o texto do paciente e retorne um JSON estruturado com: intent (agendar, cancelar, falar_com_humano), date, time, specialty e doctor_name.

Webhook WhatsApp: Implemente uma rota /api/whatsapp/webhook que:

Salve a mensagem recebida.

Verifique se o status da conversa √© 'ai'. Se sim, processe com Gemini e responda via Twilio.

Se o status for 'human', n√£o responda automaticamente (apenas salve para o atendente ver).

Se o Gemini identificar a inten√ß√£o "falar_com_humano", mude o status da conversa para 'human' e notifique o sistema.

Interface de Atendimento (Frontend React): Crie uma tela "Atendimento em Tempo Real" que liste conversas ativas. Permita que o atendente visualize o hist√≥rico completo e tenha um bot√£o "Assumir Chat" (que muda o status para 'human') e um campo para enviar mensagens manuais.

Instru√ß√£o importante: Reporte sempre a rotina completa dos arquivos alterados. N√£o execute testes funcionais agora, apenas prepare a estrutura e o c√≥digo. Utilize vari√°veis de ambiente para as chaves de API.

üõ†Ô∏è O que esperar desta implementa√ß√£o
Ao aplicar este prompt, o Replit dever√° estruturar:

O Webhook Inteligente: Onde a m√°gica acontece. Ele decide se quem responde √© o "rob√¥" ou se a mensagem deve apenas aparecer no seu painel para a secret√°ria ler.

O "C√©rebro" de Extra√ß√£o: O Gemini n√£o vai apenas "conversar", ele vai tentar extrair dados. Se o paciente disser "Quero marcar dentista pra amanh√£ √†s 10h", o c√≥digo j√° ter√° os campos specialty: 'dentista', date: '2025-12-24' e time: '10:00' prontos para inserir no banco.

A Tela de Handoff: Uma interface onde sua equipe ver√° as mensagens "pipocando" e poder√° clicar em um bot√£o para pausar a IA e digitar manualmente.